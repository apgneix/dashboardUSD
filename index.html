<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe Ejecutivo Financiero - Neix SA (USD)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .metric-card {
            border-left: 4px solid #4f46e5;
        }
        h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #374151;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        th {
            background-color: #f9fafb;
            font-weight: 600;
            color: #374151;
        }
        tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .number {
            text-align: right;
            font-variant-numeric: tabular-nums;
        }
        .text-loss {
            color: #dc2626;
        }
        .justified-text {
            text-align: justify;
        }
        .bold-marker li::marker {
            font-weight: 700;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 p-4 sm:p-6 lg:p-8">
    <div class="max-w-7xl mx-auto">

        <!-- Header -->
        <div class="card text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900">Informe Ejecutivo Financiero (USD)</h1>
            <p class="text-xl text-indigo-600 font-semibold">Neix S.A. - Agente de Liquidación y Compensación</p>
            <p class="text-md text-gray-500 mt-2">Período Analizado: 01/01/2025 al 30/09/2025</p>
        </div>

        <!-- Resumen Ejecutivo -->
        <div class="card">
            <h2><strong>Resumen Ejecutivo</strong></h2>
            <div id="summary-content">
                <p class="mb-4 justified-text">
                    El análisis del desempeño en dólares al cierre del tercer trimestre muestra un resultado acumulado de <strong>u$s4.27 millones</strong>, consolidando la rentabilidad del año gracias a un resultado positivo en septiembre que revirtió la pérdida de agosto. A pesar de la volatilidad, la capacidad de generación de la compañía se mantiene firme.
                </p>
                 <p class="mt-4 justified-text">
                    La situación patrimonial sigue siendo sólida. El Patrimonio Neto ha crecido un <strong>3.94%</strong> en el período, demostrando la capacidad de la empresa para generar valor. La gestión del activo y pasivo ha sido prudente, manteniendo los ratios de solvencia en niveles saludables.
                </p>
            </div>
             <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                <div class="p-4 bg-green-50 rounded-lg metric-card border-green-500">
                    <h4 class="font-bold text-lg text-green-800">Resultado Acumulado a Septiembre</h4>
                    <p class="text-2xl font-semibold text-green-900" id="kpi-resultado-acumulado"></p>
                    <p class="text-sm text-gray-600">Cifra final del período.</p>
                </div>
                <div class="p-4 bg-blue-50 rounded-lg metric-card border-blue-500">
                    <h4 class="font-bold text-lg text-blue-800">Activo Total a Septiembre</h4>
                    <p class="text-2xl font-semibold text-blue-900" id="kpi-activo-total"></p>
                    <p class="text-sm text-gray-600">Aumento del 9,28% desde Enero.</p>
                </div>
                <div class="p-4 bg-purple-50 rounded-lg metric-card border-purple-500">
                    <h4 class="font-bold text-lg text-purple-800">Solvencia Promedio</h4>
                    <p class="text-2xl font-semibold text-purple-900" id="kpi-solvencia"></p>
                    <p class="text-sm text-gray-600">Sólida capacidad para cubrir pasivos.</p>
                </div>
            </div>
        </div>

        <!-- 1. Evolución de Ingresos vs. Egresos -->
        <div class="card">
            <h2><strong>a) Evolución de Resultados Mensuales (Ingresos vs. Egresos)</strong></h2>
            <p class="mb-4 justified-text">
                La dinámica de resultados en USD continúa siendo variable. Septiembre arrojó un resultado positivo de <strong>u$s177 mil</strong>, una recuperación importante frente a las pérdidas de agosto. Esta volatilidad sigue reflejando la exposición a los mercados y al tipo de cambio.
            </p>
            <div class="w-full h-96 mb-6">
                <canvas id="resultadosChart"></canvas>
            </div>
            
            <h3><strong>Detalle Mensual y Ratios Clave</strong></h3>
            <div class="overflow-x-auto">
                <table id="tabla-resultados">
                    <!-- La tabla se generará con JS -->
                </table>
            </div>
            <p class="text-sm mt-4 text-gray-600 justified-text">
                Margen Neto del Período: El margen total del período en dólares se ubicó en <strong>25.99%</strong>, demostrando una alta rentabilidad sobre los ingresos generados.
            </p>
        </div>

        <!-- 2. Evolución del Resultado por Tenencia -->
        <div class="card">
            <h2><strong>b) Evolución Mensual del Resultado de la Cartera Propia</strong></h2>
            <p class="mb-4 justified-text">
                La cartera propia, principal motor de resultados, generó un resultado positivo de <strong>u$s847 mil</strong> en septiembre, alineado con el resultado general y demostrando una recuperación en la performance de los activos propios.
            </p>
            <div class="w-full h-96 mb-6">
                <canvas id="carteraChart"></canvas>
            </div>
        </div>

        <!-- 3. Evolución Patrimonial -->
        <div class="card">
            <h2><strong>c) Evolución del Activo, Pasivo y Patrimonio Neto</strong></h2>
            <p class="mb-4 justified-text">
                La estructura patrimonial en dólares se ha mantenido robusta. A pesar de la volatilidad operativa, el Patrimonio Neto ha crecido un <strong>3.94%</strong> desde enero, alcanzando los <strong>u$s8.315 millones</strong> al cierre de septiembre, manteniendo la solidez de la compañía.
            </p>
            <div class="w-full h-96 mb-6">
                <canvas id="patrimonioChart"></canvas>
            </div>
            
            <h3><strong>Detalle Mensual y Ratios Financieros</strong></h3>
            <div class="overflow-x-auto">
                <table id="tabla-patrimonio">
                     <!-- La tabla se generará con JS -->
                </table>
            </div>
        </div>

        <!-- 4. Incidencia de Gastos por Centro de Costos -->
        <div class="card">
            <h2><strong>d) Incidencia de Gastos por Centro de Costos (Acumulado Ene-Sep)</strong></h2>
            <p class="mb-4 justified-text">
                El área de "Productores" mantiene la mayor concentración de los egresos acumulados, con un <strong>56.36%</strong> del total. La estructura general de costos por centro no presenta cambios significativos respecto a meses anteriores.
            </p>
            <div class="flex flex-col md:flex-row items-center gap-6">
                <div class="w-full md:w-1/2 h-80">
                    <canvas id="gastosChart"></canvas>
                </div>
                <div class="w-full md:w-1/Deberías ver los cambios reflejados. ¡Avísame si necesitás algo más!/2">
                    <ul class="space-y-2" id="lista-gastos-cc">
                        <!-- Generado por JS -->
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 5. Desglose de Gastos Fijos -->
        <div class="card">
            <h2><strong>e) Desglose de Gastos Fijos (Acumulado Ene-Sep)</strong></h2>
            <p class="mb-4 justified-text">
                En dólares, los gastos de personal siguen siendo el principal componente de los costos fijos. "Sueldos" (<strong>59.97%</strong>) y "Cargas Sociales" (<strong>14.73%</strong>) representan en conjunto el <strong>74.70%</strong> del total acumulado.
            </p>
            <div class="flex flex-col md:flex-row items-center gap-6">
                <div class="w-full md:w-1/2 h-80">
                    <canvas id="gastosFijosChart"></canvas>
                </div>
                <div class="w-full md:w-1/2">
                    <ul class="space-y-2" id="lista-gastos-fijos">
                        <!-- Generado por JS -->
                    </ul>
                </div>
            </div>
        </div>


        <!-- Conclusiones -->
        <div class="card">
             <h2><strong>Conclusiones y Recomendaciones</strong></h2>
            <div id="recommendations-content">
                 <ol class="list-decimal list-inside space-y-3 bold-marker">
                    <li class="justified-text">
                        <strong>Recuperación y Volatilidad Persistente:</strong> Septiembre muestra una bienvenida recuperación, pero la volatilidad sigue siendo el rasgo dominante del año. La dependencia del resultado de la cartera propia es alta.
                        <br>Recomendación: Continuar con la revisión de la política de gestión de riesgos. Capitalizar la buena performance de septiembre para analizar qué estrategias funcionaron y replicarlas, mientras se mantienen los límites de exposición estrictos.
                    </li>
                    <li class="justified-text">
                        <strong>Fortaleza y Crecimiento Patrimonial:</strong> El crecimiento del Patrimonio Neto (3.94% YTD) es una excelente noticia y el principal pilar de la compañía, permitiendo absorber los shocks operativos y seguir creciendo.
                        <br>Recomendación: Evaluar la posibilidad de reinvertir una porción de las utilidades acumuladas en líneas de negocio con ingresos más predecibles (ej. comisiones, research) para estabilizar el flujo de fondos mensual.
                    </li>
                    <li class="justified-text">
                        <strong>Análisis de Estructura de Costos:</strong> La estructura de costos se mantiene estable y altamente concentrada en "Productores" y en la masa salarial.
                        <br>Recomendación: Iniciar un análisis de eficiencia sobre los costos de "Productores" para entender mejor su componente fijo vs. variable. Buscar optimizaciones en gastos fijos que no afecten la capacidad operativa.
                    </li>
                </ol>
            </div>
        </div>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- DATOS FINANCIEROS (USD) - ACTUALIZADO A SEPTIEMBRE Y CORREGIDO (PN) ---
        const data = {
            patrimonial: { 
                activo: [18756283.81, 24733788.54, 24504594.19, 29595725.50, 30084333.42, 34029679.68, 27714556.79, 25819222.98, 20498441.42],
                pasivo: [10755633.74, 16410941.09, 16582546.79, 19205681.02, 20998291.76, 24313543.51, 18761574.37, 16861461.91, 12182672.72],
                // PN = Activo - Pasivo
                pn: [8000650.07, 8322847.45, 7922047.40, 10390044.48, 9086041.66, 9716136.17, 8952982.42, 8957761.07, 8315768.70]
            },
            resultados: { 
                ingresos: [1895470.28, 1663285.27, 586785.18, 2868228.10, 940443.01, 1735939.20, 1693917.90, 2492321.62, 2554781.55],
                egresos: [1067719.44, 926297.73, 446081.06, 1274530.17, 1209861.78, 960450.02, 1394824.79, 2503505.24, 2377275.66],
                resultado: [827750.84, 736987.54, 140704.12, 1593697.93, -269418.77, 775489.18, 299093.11, -11183.62, 177505.89]
            },
            cartera: { 
                resultadoFinal: [1030772.29, 982896.35, 277421.35, 2116621.99, 529229.48, 1119618.79, 681974.18, 63058.56, 847688.00]
            },
            gastos: { 
                labels: ['Productores', 'Mesa', 'Neix (Corp.)', 'Back Office', 'Administración', 'IT', 'RRHH', 'Banca Comercial', 'MKTG', 'Mendoza', 'Banca Privada'],
                acumulado: [1721419.19, 546096.02, 441765.02, 75889.90, 70558.13, 62668.04, 61327.23, 23851.20, 23379.02, 19292.31, 8229.53]
            },
            gastosFijos: {
                labels: ['Sueldos', 'Cargas Sociales', 'Serv. Contratados', 'Honorarios', 'Alquileres', 'Telefonía/Internet', 'Suscripciones', 'Obra Social', 'Autónomos'],
                acumulado: [1998988.52, 491140.36, 453340.22, 162168.50, 160807.54, 23913.74, 22234.33, 19424.70, 2337.06]
            }
        };
        const meses = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep'];

        // --- HELPERS ---
        const formatCurrency = (value) => {
            const formatter = new Intl.NumberFormat('en-US', {
                style: 'decimal',
                minimumFractionDigits: 0, // SIN DECIMALES
                maximumFractionDigits: 0  // SIN DECIMALES
            });
            return 'u$s ' + formatter.format(value);
        };

        // --- KPIs ---
        // El resultado acumulado se toma ahora del array patrimonial para consistencia
        const resultadoAcumuladoFinal = data.resultados.resultado.reduce((a, b) => a+b, 0);
        document.getElementById('kpi-resultado-acumulado').innerText = formatCurrency(resultadoAcumuladoFinal);
        document.getElementById('kpi-activo-total').innerText = formatCurrency(data.patrimonial.activo[data.patrimonial.activo.length - 1]);
        const solvenciaPromedio = data.patrimonial.activo.reduce((sum, val, i) => sum + (val / data.patrimonial.pasivo[i]), 0) / meses.length;
        document.getElementById('kpi-solvencia').innerText = solvenciaPromedio.toFixed(2); // CON 2 DECIMALES
        
        // --- TABLA RESULTADOS ---
        const tablaResultados = document.getElementById('tabla-resultados');
        let headerResultados = `<thead><tr><th>Mes</th><th class="number">Ingresos</th><th class="number">Egresos</th><th class="number">Resultado Mensual</th><th class="number">Margen Neto</th></tr></thead>`;
        let bodyResultados = '<tbody>';
        let totalIngresos = 0, totalEgresos = 0, totalResultado = 0;
        meses.forEach((mes, i) => {
            const ingreso = data.resultados.ingresos[i];
            const egreso = data.resultados.egresos[i];
            const resultado = data.resultados.resultado[i];
            const margen = ingreso !== 0 ? resultado / ingreso : 0;
            totalIngresos += ingreso;
            totalEgresos += egreso;
            totalResultado += resultado;
            bodyResultados += `
                <tr>
                    <td>${mes}</td>
                    <td class="number">${formatCurrency(ingreso)}</td>
                    <td class="number">${formatCurrency(egreso)}</td>
                    <td class="number font-semibold ${resultado < 0 ? 'text-loss' : ''}">${formatCurrency(resultado)}</td>
                    <td class="number ${margen < 0 ? 'text-loss' : ''}">${(margen * 100).toFixed(2)}%</td> 
                </tr>
            `;
        });
        // Aseguramos que el totalResultado coincida con el KPI
        const margenTotal = totalIngresos !== 0 ? totalResultado / totalIngresos : 0;
        bodyResultados += `
            <tr class="font-bold bg-gray-200">
                <td>Total Período</td>
                <td class="number">${formatCurrency(totalIngresos)}</td>
                <td class="number">${formatCurrency(totalEgresos)}</td>
                <td class="number">${formatCurrency(totalResultado)}</td>
                <td class="number">${(margenTotal * 100).toFixed(2)}%</td>
            </tr>
        `;
        bodyResultados += '</tbody>';
        tablaResultados.innerHTML = headerResultados + bodyResultados;

        // --- TABLA PATRIMONIO (MODIFICADA) ---
        const tablaPatrimonio = document.getElementById('tabla-patrimonio');
        let headerPatrimonio = `<thead><tr><th>Mes</th><th class="number">Activo</th><th class="number">Pasivo</th><th class="number">Pat. Neto</th><th class="number">Solvencia</th><th class="number">Apalancamiento</th></tr></thead>`;
        let bodyPatrimonio = '<tbody>';
        meses.forEach((mes, i) => {
            const activo = data.patrimonial.activo[i];
            const pasivo = data.patrimonial.pasivo[i];
            const pn = data.patrimonial.pn[i]; // Nuevo PN
            const solvencia = pasivo !== 0 ? activo / pasivo : 0;
            const apalancamiento = pn !== 0 ? pasivo / pn : 0; // Recalculado
            
            bodyPatrimonio += `
                <tr>
                    <td>${mes}</td>
                    <td class="number">${formatCurrency(activo)}</td>
                    <td class="number">${formatCurrency(pasivo)}</td>
                    <td class="number font-semibold">${formatCurrency(pn)}</td>
                    <td class="number">${solvencia.toFixed(2)}</td> 
                    <td class="number">${apalancamiento.toFixed(2)}</td>
                </tr>
            `;
        });
        bodyPatrimonio += '</tbody>';
        tablaPatrimonio.innerHTML = headerPatrimonio + bodyPatrimonio;

        // --- GRÁFICOS ---
        const chartOptions = (hasNegativeValues = false) => ({
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    ticks: {
                        callback: function(value) {
                            return 'u$s ' + (value / 1e6).toFixed(0) + 'M'; // SIN DECIMALES
                        }
                    }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: ${formatCurrency(context.raw)}`;
                        }
                    }
                }
            }
        });
        
        const pieChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                     callbacks: {
                        label: function(context) {
                            return ` ${context.label}: ${context.raw.toFixed(2)}%`; // CON 2 DECIMALES
                        }
                    }
                }
            }
        };

        // Gráfico 1: Resultados
        new Chart(document.getElementById('resultadosChart'), {
            type: 'bar',
            data: {
                labels: meses,
                datasets: [
                    {
                        label: 'Ingresos',
                        data: data.resultados.ingresos,
                        backgroundColor: 'rgba(59, 130, 246, 0.7)',
                        order: 2
                    },
                    {
                        label: 'Egresos',
                        data: data.resultados.egresos,
                        backgroundColor: 'rgba(239, 68, 68, 0.7)',
                        order: 2
                    },
                    {
                        label: 'Resultado Mensual',
                        data: data.resultados.resultado,
                        borderColor: 'rgb(22, 163, 74)',
                        backgroundColor: 'rgba(22, 163, 74, 0.1)',
                        borderWidth: 2,
                        type: 'line',
                        tension: 0.2,
                        fill: false,
                        order: 1
                    }
                ]
            },
            options: chartOptions(true)
        });

        // Gráfico 2: Cartera Propia
        new Chart(document.getElementById('carteraChart'), {
            type: 'bar',
            data: {
                labels: meses,
                datasets: [
                    {
                        label: 'Resultado Final Cartera (Mensual)',
                        data: data.cartera.resultadoFinal,
                         backgroundColor: data.cartera.resultadoFinal.map(v => v < 0 ? 'rgba(220, 38, 38, 0.7)' : 'rgba(79, 70, 229, 0.7)'),
                    }
                ]
            },
            options: chartOptions(true)
        });

        // Gráfico 3: Patrimonio (MODIFICADO)
        new Chart(document.getElementById('patrimonioChart'), {
            type: 'line',
            data: {
                labels: meses,
                datasets: [
                    {
                        label: 'Activo',
                        data: data.patrimonial.activo,
                        borderColor: 'rgb(37, 99, 235)',
                        backgroundColor: 'rgba(37, 99, 235, 0.2)',
                        fill: true,
                        tension: 0.3
                    },
                    {
                        label: 'Pasivo',
                        data: data.patrimonial.pasivo,
                        borderColor: 'rgb(217, 70, 239)',
                        backgroundColor: 'rgba(217, 70, 239, 0.2)',
                        fill: true,
                        tension: 0.3
                    },
                    {
                        label: 'Patrimonio Neto', // Etiqueta actualizada
                        data: data.patrimonial.pn, // Usando el nuevo array de PN
                        borderColor: 'rgb(14, 165, 233)',
                        backgroundColor: 'rgba(14, 165, 233, 0.2)',
                        fill: true,
                        tension: 0.3
                    }
                ]
            },
            options: chartOptions()
        });
        
        // --- Procesamiento y Gráfico 4: GASTOS POR CENTRO DE COSTO ---
        const totalGastosCC = data.gastos.acumulado.reduce((a, b) => a + b, 0);
        const porcentajesGastosCC = data.gastos.acumulado.map(g => (g / totalGastosCC) * 100);
        const listaGastosCC = document.getElementById('lista-gastos-cc');
        data.gastos.labels.forEach((label, i) => {
            const li = document.createElement('li');
            li.className = 'flex justify-between';
            li.innerHTML = `<span>${i+1}. ${label}:</span> <span class="font-semibold">${formatCurrency(data.gastos.acumulado[i])} (${porcentajesGastosCC[i].toFixed(2)}%)</span>`; // CON 2 DECIMALES
            listaGastosCC.appendChild(li);
        });

        new Chart(document.getElementById('gastosChart'), {
            type: 'pie',
            data: {
                labels: data.gastos.labels,
                datasets: [{
                    label: '% de Gastos Acumulados',
                    data: porcentajesGastosCC,
                    backgroundColor: ['#4f46e5', '#7c3aed', '#db2777', '#f97316', '#eab308', '#22c55e', '#06b6d4', '#3b82f6', '#8b5cf6', '#d946ef', '#f43f5e'],
                    hoverOffset: 4
                }]
            },
            options: pieChartOptions
        });

        // --- Procesamiento y Gráfico 5: GASTOS FIJOS ---
        const totalGastosFijos = data.gastosFijos.acumulado.reduce((a, b) => a + b, 0);
        const porcentajesGastosFijos = data.gastosFijos.acumulado.map(g => (g / totalGastosFijos) * 100);
        const listaGastosFijos = document.getElementById('lista-gastos-fijos');
        data.gastosFijos.labels.forEach((label, i) => {
            const li = document.createElement('li');
            li.className = 'flex justify-between';
            li.innerHTML = `<span>${i+1}. ${label}:</span> <span class="font-semibold">${formatCurrency(data.gastosFijos.acumulado[i])} (${porcentajesGastosFijos[i].toFixed(2)}%)</span>`; // CON 2 DECIMALES
            listaGastosFijos.appendChild(li);
        });

        new Chart(document.getElementById('gastosFijosChart'), {
            type: 'pie',
            data: {
                labels: data.gastosFijos.labels,
                datasets: [{
                    label: '% de Gastos Fijos Acumulados',
                    data: porcentajesGastosFijos,
                    backgroundColor: ['#1d4ed8', '#0e7490', '#c2410c', '#b45309', '#a16207', '#4d7c0f', '#15803d', '#0f766e', '#be185d'],
                    hoverOffset: 4
                }]
            },
            options: pieChartOptions
        });

    });
</script>
</body>
</html>





